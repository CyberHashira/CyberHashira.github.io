<!DOCTYPE html>
<head>
	<title>CyberHashira | OpenSSL | Message Authentication Code.</title>
	<meta charset="UTF-8">
	<meta name="description" content="This video tutorial series teaches you how to use the OpenSSL utility. OpenSSL is a highly popular cryptographic tool. My goal is to cover every feature of OpenSSL eventually. Whether you're a beginner or an advanced user, I'm sure there will be something for you.">
	<meta name="keywords" content="OpenSSL, OpenSSL Tutorials, Generating Keys using OpenSSL, Generating Certificates using OpenSSL, OpenSSL CA, Encryption using OpenSSL, Signing Using OpenSSL.">
	<meta name="author" content="Cyber Hashira">
</head>
<link rel="stylesheet" href="../../css/style.css">

<h1>Message Authentication Code (MAC) using OpenSSL</h1>
<br><br>

<div class="notes">A Message Authentication Code (MAC) is a cryptographic technique used to verify the integrity and authenticity of a message. It ensures that the message has not been altered or tampered with during transmission and that it was indeed generated by the purported sender.</div><br>
<hr><br>

<h3> - A basic example for MAC.</h3>
<div class="notes">The MAC is a fixed-size output derived from the combination of the message and the secret key.</div>
<span class="cmds">openssl rand -hex -out key 16</span><br>
<span class="cmds">echo -n `cat message.txt``cat key` | openssl sha256</span><br><br><br>


<h3> - HMAC/CMAC using OpenSSL</h3>
<div class="notes">Generating a key.</div>
<span class="cmds">openssl rand -out key 16</span><br><br>

<div class="notes">Display binary data in Hex format.</div>
<span class="cmds">xxd -p key</span><br><br>

<div class="notes">Generate SHA1_HMAC.</div>
<span class="cmds">openssl sha1 -hmac 1130ba6fcfbacd5e5a6d3645314e6e93 -out earth.sha1hmac Earth.txt</span><br><br>

<div class="notes">Generate SHA256_HMAC.</div>
<span class="cmds">openssl sha256 -hmac 1130ba6fcfbacd5e5a6d3645314e6e93 -out earth.sha256hmac Earth.txt</span><br><br>

<div class="notes">Generating SHA1_HMAC using 'openssl dgst'.</div>
<span class="cmds">openssl dgst -sha1 -hmac 1130ba6fcfbacd5e5a6d3645314e6e93 Earth.txt</span><br><br>

<div class="notes">Generating SHA1_HMAC using 'openssl dgst' and outputing to a file.</div>
<span class="cmds">openssl dgst -sha1 -hmac 1130ba6fcfbacd5e5a6d3645314e6e93 -out earth.sha1hmac Earth.txt</span><br><br>

<div class="notes">Generating SHA256_HMAC using 'openssl dgst'.</div>
<span class="cmds">openssl dgst -sha256 -hmac 1130ba6fcfbacd5e5a6d3645314e6e93 Earth.txt</span><br><br>

<div class="notes">Alternate way to generate HMAC.</div>
<span class="cmds">openssl dgst -mac hmac -sha1 -macopt hexkey:`xxd -p key` Earth.txt</span><br>
<span class="cmds">openssl dgst -mac hmac -sha256 -macopt hexkey:`xxd -p key` Earth.txt</span><br><br>

<div class="notes">Generating CMAC digest.</div>
<span class="cmds">openssl dgst -mac cmac -macopt cipher:aes-128-cbc -macopt hexkey:`xxd -p key` -sha1 Earth.txt</span><br>
<span class="cmds">openssl dgst -mac cmac -macopt cipher:aes-128-cbc -macopt hexkey:`xxd -p key` -sha256 Earth.txt</span><br><br>
</html>
